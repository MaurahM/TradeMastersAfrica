<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Intelligence • Trade Masters</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #020617;
            --surface: #0f172a;
            --accent: #6366f1;
            --accent-glow: rgba(99, 102, 241, 0.2);
            --emerald: #10b981;
            --rose: #f43f5e;
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
            --border: rgba(255, 255, 255, 0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Plus Jakarta Sans', sans-serif; }

        body {
            background-color: var(--bg);
            background-image: radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.05) 0px, transparent 50%);
            color: var(--text-main);
            min-height: 100vh;
            padding: 24px;
        }

        .container { max-width: 1300px; margin: 0 auto; }

        /* Header Navigation */
        header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 32px;
        }
        .brand { display: flex; align-items: center; gap: 14px; }
        .logo-box {
            width: 44px; height: 44px; background: linear-gradient(135deg, var(--accent), #a855f7);
            border-radius: 12px; display: flex; align-items: center; justify-content: center;
            font-weight: 800; color: white;
        }

        /* Filter Controls */
        .toolbar {
            background: var(--surface); border: 1px solid var(--border);
            padding: 16px; border-radius: 16px;
            display: flex; gap: 16px; align-items: center; flex-wrap: wrap;
            margin-bottom: 24px;
        }
        input[type=date], select {
            padding: 10px 14px; border-radius: 10px; border: 1px solid var(--border);
            background: rgba(0,0,0,0.2); color: white; font-size: 13px; outline: none;
        }

        /* Metrics Grid */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px; margin-bottom: 24px; }
        .card { 
            background: var(--surface); border: 1px solid var(--border); 
            padding: 20px; border-radius: 16px; position: relative;
            overflow: hidden;
        }
        .card h3 { font-size: 12px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px; }
        .card .value { font-size: 28px; font-weight: 800; margin: 10px 0; }
        .trend { font-size: 12px; display: flex; align-items: center; gap: 4px; }
        .trend.up { color: var(--emerald); }
        .trend.down { color: var(--rose); }

        /* Analytics Panels */
        .charts-container { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 20px; }
        .panel { 
            background: var(--surface); border: 1px solid var(--border); 
            padding: 24px; border-radius: 20px; 
        }
        .panel h4 { margin-bottom: 20px; font-size: 16px; display: flex; justify-content: space-between; align-items: center; }

        /* Tables */
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; font-size: 11px; color: var(--text-dim); padding: 12px 8px; border-bottom: 1px solid var(--border); }
        td { padding: 14px 8px; font-size: 13px; border-bottom: 1px solid var(--border); }
        tr:last-child td { border: none; }

        .btn {
            background: var(--accent); color: white; border: none; padding: 10px 18px;
            border-radius: 10px; font-weight: 700; cursor: pointer; transition: 0.2s; font-size: 13px;
        }
        .btn-ghost {
            background: transparent; border: 1px solid var(--border); color: var(--text-dim);
            padding: 10px 18px; border-radius: 10px; cursor: pointer; font-size: 13px;
        }
        .btn-ghost:hover { color: white; border-color: white; }

        @media (max-width: 1024px) { .charts-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="brand">
                <div class="logo-box">AI</div>
                <div>
                    <h1 style="font-size: 20px; font-weight: 800;">Analytics Intelligence</h1>
                    <p style="font-size: 12px; color: var(--text-dim);">Real-time platform performance & yield</p>
                </div>
            </div>
            <button class="btn-ghost" onclick="location.href='admindashboard.html'">Return to Terminal</button>
        </header>

        <div class="toolbar">
            <div style="display:flex; align-items:center; gap:8px;">
                <label style="font-size:12px; color:var(--text-dim)">Period:</label>
                <input id="from" type="date">
                <span style="color:var(--border)">—</span>
                <input id="to" type="date">
            </div>
            <select id="groupBy">
                <option value="day">Interval: Daily</option>
                <option value="week">Interval: Weekly</option>
                <option value="month">Interval: Monthly</option>
            </select>
            <div style="margin-left:auto; display:flex; gap:10px;">
                <button class="btn" onclick="applyFilters()">Refresh Data</button>
                <button class="btn-ghost" onclick="exportCSV()">Export Dataset</button>
            </div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Total Enrollments</h3>
                <div class="value" id="totalEnrolls">0</div>
                <div class="trend up">▲ 12.4% <span style="color:var(--text-dim)">vs last period</span></div>
            </div>
            <div class="card">
                <h3>Platform Revenue</h3>
                <div class="value" id="revenue">$0</div>
                <div class="trend up">▲ 8.2% <span style="color:var(--text-dim)">yield growth</span></div>
            </div>
            <div class="card">
                <h3>Active Retention</h3>
                <div class="value" id="avgComplete">0%</div>
                <div class="trend down">▼ 1.5% <span style="color:var(--text-dim)">churn risk</span></div>
            </div>
            <div class="card">
                <h3>New Acquisitions</h3>
                <div class="value" id="newStudents">0</div>
                <div class="trend up">▲ 24 <span style="color:var(--text-dim)">this week</span></div>
            </div>
        </div>

        <div class="charts-container">
            <div class="panel">
                <h4>Growth Velocity <span style="font-weight:400; font-size:12px; color:var(--text-dim)">Enrollments vs Revenue</span></h4>
                <canvas id="mainChart"></canvas>
            </div>
            <div class="panel">
                <h4>Top Yielding Courses</h4>
                <table id="topTable">
                    <thead>
                        <tr>
                            <th>COURSE</th>
                            <th>ENROLLS</th>
                            <th>REVENUE</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div class="panel">
            <h4>Engagement Distribution <span style="font-weight:400; font-size:12px; color:var(--text-dim)">Course Completion Accuracy</span></h4>
            <canvas id="engChart" style="height:220px"></canvas>
        </div>
    </div>

    

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const demoCourses = [
            {id:1, title:'Full-Stack Web Development', price: 199},
            {id:2, title:'UI/UX Design Fundamentals', price: 149},
            {id:3, title:'Digital Marketing: SEO', price: 99},
            {id:4, title:'Data Science with Python', price: 249}
        ];

        function generateDemo(){
            const records = [];
            const today = new Date();
            for(let d=60; d>=0; d--){
                const date = new Date(today); date.setDate(today.getDate()-d);
                const day = date.toISOString().slice(0,10);
                demoCourses.forEach(c=>{
                    const enrolls = Math.floor(Math.random() * 5) + 1;
                    records.push({
                        date: day,
                        courseId: c.id,
                        enrolls: enrolls,
                        revenue: enrolls * c.price,
                        completion: Math.floor(Math.random() * 40) + 50
                    });
                });
            }
            return records;
        }

        const raw = generateDemo();
        let mainChart, engChart;

        function initCharts(){
            Chart.defaults.color = '#94a3b8';
            Chart.defaults.borderColor = 'rgba(255,255,255,0.05)';

            const ctx = document.getElementById('mainChart').getContext('2d');
            mainChart = new Chart(ctx, {
                data: {
                    labels: [],
                    datasets: [
                        { type: 'line', label: 'Enrollments', data: [], borderColor: '#6366f1', tension: 0.4, yAxisID: 'y' },
                        { type: 'bar', label: 'Revenue', data: [], backgroundColor: 'rgba(16, 185, 129, 0.2)', borderRadius: 4, yAxisID: 'y1' }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { position: 'left', grid: { display: false } },
                        y1: { position: 'right', ticks: { callback: v => '$' + v } }
                    }
                }
            });

            const ctx2 = document.getElementById('engChart').getContext('2d');
            engChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{ label: 'Avg Completion %', data: [], backgroundColor: '#6366f1', borderRadius: 6 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, max: 100 } }
                }
            });
        }

        function applyFilters(){
            const from = document.getElementById('from').value;
            const to = document.getElementById('to').value;
            const filtered = raw.filter(r => (!from || r.date >= from) && (!to || r.date <= to));

            // Metric Calculations
            const totalEnrolls = filtered.reduce((s,r) => s + r.enrolls, 0);
            const totalRev = filtered.reduce((s,r) => s + r.revenue, 0);
            const avgComp = Math.round(filtered.reduce((s,r) => s + r.completion, 0) / filtered.length);

            document.getElementById('totalEnrolls').textContent = totalEnrolls.toLocaleString();
            document.getElementById('revenue').textContent = `$${totalRev.toLocaleString()}`;
            document.getElementById('avgComplete').textContent = `${avgComp}%`;
            document.getElementById('newStudents').textContent = Math.floor(totalEnrolls * 0.4);

            // Chart Updates
            const dayMap = {};
            filtered.forEach(r => {
                if(!dayMap[r.date]) dayMap[r.date] = { e: 0, r: 0 };
                dayMap[r.date].e += r.enrolls;
                dayMap[r.date].r += r.revenue;
            });

            const labels = Object.keys(dayMap).sort();
            mainChart.data.labels = labels;
            mainChart.data.datasets[0].data = labels.map(l => dayMap[l].e);
            mainChart.data.datasets[1].data = labels.map(l => dayMap[l].r);
            mainChart.update();

            // Table Updates
            const courseMap = {};
            filtered.forEach(r => {
                if(!courseMap[r.courseId]) courseMap[r.courseId] = { e: 0, r: 0 };
                courseMap[r.courseId].e += r.enrolls;
                courseMap[r.courseId].r += r.revenue;
            });

            const topData = Object.keys(courseMap).map(id => ({
                id: id,
                title: demoCourses.find(c => c.id == id).title,
                e: courseMap[id].e,
                r: courseMap[id].r
            })).sort((a,b) => b.r - a.r);

            const tbody = document.querySelector('#topTable tbody');
            tbody.innerHTML = '';
            topData.forEach(t => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${t.title}</td><td>${t.e}</td><td>$${t.r.toLocaleString()}</td>`;
                tbody.appendChild(tr);
            });

            engChart.data.labels = topData.map(t => t.title);
            engChart.data.datasets[0].data = topData.map(() => Math.floor(Math.random()*30)+60);
            engChart.update();
        }

        function exportCSV() { alert("Building Intelligence Export..."); }

        window.onload = () => {
            const today = new Date();
            const lastMonth = new Date(); lastMonth.setDate(today.getDate()-30);
            document.getElementById('from').value = lastMonth.toISOString().slice(0,10);
            document.getElementById('to').value = today.toISOString().slice(0,10);
            initCharts();
            applyFilters();
        };
    </script>
</body>
</html>